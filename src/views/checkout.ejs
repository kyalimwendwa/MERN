<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/prod.css">
    <link rel="stylesheet" href="/cards.css">
    <link rel="stylesheet" href="/style.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@4.0.0/fonts/remixicon.css" rel="stylesheet"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300&display=swap" rel="stylesheet">
    <title>Shopping cart</title>

    <!-- Include this style block at the end of your checkout.ejs file -->
<style>
  .cartBar{
    width: 100%;
    
    display: flex;
  }
  .cartBar .left{
    width: 70%;
    height: max-content;
    display: block;
  }
  .cartBar .right{
    width: 30%;
    height: max-content;
    display: block;
    background-color: #fff;
  }
  .cartBar .right form{
    width: 100%;
    padding: 2rem;
    height: max-content;
    margin-top: 2rem;
    
  }
  .cartBar .right form label{
    font-size: 13px;
    color: #213047;
  }
  .cartBar .right form input{
    height: 35px;
    display:flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    margin-top: 10px;
    margin-bottom: 10px;
    border-radius: 1px;
    border: none;
    color: #454545;
    font-size: 14px;
    font-weight: 400;
    border: 1px solid #acbebe;
    background-color: #fff;
    outline: none;
    padding: 5px;
}
.cartBar .right form input:focus{
    outline: 0;
    border-color: #213047;
}
.cartBar .right form button{
    height: 40px;
    background-color: #213047;
    font-size: 14px;
    color: white;
    width: 100%;
    outline: none;
    border: none;
    border-radius: 8px;
    margin-top: 20px;
   cursor: pointer;
}
.cartBar .right form .payment{
  display: flex;
  width: 100%;
  align-items: center;
  justify-content: center;
  
}
.cartBar .right form .payment label{
  align-items: center;
  justify-content: center;
}
.cartBar .right form .payment input[type="radio"] {
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
  width: 16px; /* Set the desired size */
  height: 16px; /* Set the desired size */
   /* Set the border color */
  border-radius: 50%; /* Make it circular */
  margin-right: 8px; /* Adjust spacing between the radio button and label */
  cursor: pointer;
  margin-right: 10px;
  margin-left: 10px;
}
.cartBar .right form .payment input[type="radio"]:checked {
            
            border: 2px solid #4caf50; /* Set the border color to green when checked */
        }
.cartBar .right form .payment input[type="radio"] {
            border: 2px solid #acbebe; /* Set the original border color */
        }
  .payment-option-form {
            display: none;
        }

        .payment-option-form.active {
            display: block;
        }

        

        input[type="radio"] {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }

       
</style>

</head>
<body>
    <% products.forEach(product => { %>
        <% }); %>
        <header>
          <div class="logo">
            Ahub
          </div>
      
          <nav class="nav">
            <li class="dropdown">
              Living Room
              <div class="dropdown-content">
                <a href="/products/LivingRoom/Sectionals" class="link-with-icon">Sectionals<i class="ri-arrow-right-s-line"></i></a>
                <a href="/products/LivingRoom/Sofas" class="link-with-icon">Sofas<i class="ri-arrow-right-s-line"></i></a>
                <a href="/products/LivingRoom/Chairs" class="link-with-icon">Chairs<i class="ri-arrow-right-s-line"></i></a>
                <a href="/products/LivingRoom/Tv Stands" class="link-with-icon">TV Stands<i class="ri-arrow-right-s-line"></i></a>
                <a href="/products/LivingRoom/Coffee Table" class="link-with-icon">Coffee Table<i class="ri-arrow-right-s-line"></i></a>
              </div>
            </li>
      
            <li class="dropdown">
              Dining Room
              <div class="dropdown-content">
                <a href="/products/DiningRoom/Dining Tables" class="link-with-icon">Dining Tables<i class="ri-arrow-right-s-line"></i></a>
                <a href="/products/DiningRoom/Dining Chairs" class="link-with-icon">Dining Chairs<i class="ri-arrow-right-s-line"></i></a>
                <a href="/products/DiningRoom/Dining Sets" class="link-with-icon">Dining Sets<i class="ri-arrow-right-s-line"></i></a>
              </div>
            </li>
      
            <li class="dropdown">
              Bedroom
              <div class="dropdown-content">
                <a href="/products/Bedroom/Beds" class="link-with-icon">Beds<i class="ri-arrow-right-s-line"></i></a>
              </div>
            </li>
      
            <li class="dropdown">
              Outdoor
              <div class="dropdown-content">
                <a href="/products/Outdoor/Outdoor Sectionals" class="link-with-icon" >Outdoor Sectionals<i class="ri-arrow-right-s-line"></i></a>
                <a href="/products/Outdoor/Outdoor Chairs" class="link-with-icon">Outdoor Chairs<i class="ri-arrow-right-s-line"></i></a>
              </div>
            </li>
      
            <li class="dropdown">
              Home office
              <div class="dropdown-content">
                <a href="/products/HomeOffice/Office Chairs" class="link-with-icon">Office Chairs<i class="ri-arrow-right-s-line"></i></a>
                <a href="/products/HomeOffice/Office Tables" class="link-with-icon">Office Tables<i class="ri-arrow-right-s-line"></i></a>
                <a href="/products/HomeOffice/Office Sets" class="link-with-icon">Office Sets<i class="ri-arrow-right-s-line"></i></a>
              </div>
            </li>
          </nav>
      
          <div class="icons">
            <a href="/login"><i class="ri-user-line"></i></a>
            <a href="/shoppingcart"><i class="ri-shopping-bag-2-line"></i></a>
          </div>
        </header>




        <!-- checkout.ejs -->
<!-- checkout.ejs -->
<h2>Checkout</h2>
<div class="cartBar">
         <div class="left">
    <ul id="cartItems">

    </ul>
           </div>
          <div class="right">
    <form id="orderForm" method="post" action="/orders"enctype="multipart/form-data">
      <label for="name">Username</label>
      <input type="text" id="name" name="name" required>

      <label for="email">Email:</label>
      <input type="email" id="email" name="email" required>
      <label for="contact">Contact:</label>
      <input type="number" id="contact" name="contact" required>
      <div class="flex" style="display: flex; gap: 2rem;">
        <div class="flex">
          <label for="">Country</label>
          <input type="text" id="country" name="country" style="border-top: none;border-left: none;border-right: none;">
        </div>
        <div class="flex">
          <label for="">City</label>
          <input type="text" id="city" name="city" style="border-top: none;border-left: none;border-right: none;">
        </div>
        
      </div>
       <label for="email">Physical Address</label>
       <input type="text" id="address" name="address" required>

      <label for="paymentOption">Select Payment Option:</label>
      <div class="payment">
        <input type="radio" id="mpesa" name="paymentoption" value="mpesa" onclick="showPaymentForm('mpesa')">
        <label for="mpesa">M-Pesa</label>

        <input type="radio" id="creditCard" name="paymentoption" value="creditCard" onclick="showPaymentForm('creditCard')">
        <label for="creditCard">Credit Card</label>

        <input type="radio" id="cashOnDelivery" name="paymentoption" value="Pay On Delivery" onclick="showPaymentForm('cashOnDelivery')">
        <label for="cashOnDelivery">Pay on Delivery</label>
        
        
      </div>

      <!-- Payment Forms -->
      <div class="payment-option-form" id="mpesaForm">
          <!-- M-Pesa payment form fields go here -->
          <label for="mpesaPhoneNumber">M-Pesa Phone Number:</label>
          <input type="text" id="mpesaPhoneNumber" name="mpesaPhoneNumber" placeholder="Enter your M-Pesa phone number">
      </div>

      <div class="payment-option-form" id="creditCardForm">
          <!-- Credit Card payment form fields go here -->
          
          <label for="creditCardNumber">Credit Card Number:</label>
          <input type="text" id="creditCardNumber" name="creditCardNumber" placeholder="Enter your credit card number" style="border-top: none;border-left: none;border-right: none;">
          <!-- Other credit card fields go here -->
          <label for="">Cardholder's Name</label>
          <input type="text" id="carduser" placeholder="jsmith" style="border-top: none;border-left: none;border-right: none;">

          <div class="flex" style="display: flex; gap: 2rem;">
            <div class="flex">
              <label for="">Card Expiry Date</label>
              <input type="text" id="date"  style="border-top: none;border-left: none;border-right: none;">
            </div>
            <div class="flex">
              <label for="">CVV</label>
              <input type="text" id="cvv" style="border-top: none;border-left: none;border-right: none;">
            </div>
            
          </div>
      </div>

      <div class="payment-option-form" id="cashOnDeliveryForm">
          <!-- No additional form fields for Cash on Delivery -->
      </div>
<!-- Inside the form -->

<input type="hidden" id="orderDateTime" name="orderDateTime" readonly>
<input type="hidden" name="productNames" id="productNames">
<input type="hidden" name="images" id="images">
<input type="hidden" name="quantities" id="quantities">
<input type="hidden" name="totalprice" id="totalprice">

<input type="hidden" name="cartData" id="cartData">

      <button type="submit" id="allprice" name="allprice" ></button>
     
       </form>
 
 

  
          </div>
</div>



        
        <section class="footer1">
            <div class="footer-content">
             <h1>Our Company</h1>
               <ul>
                 <li>Home</li>
                 <li>Terms & Conditions</li>
                 <li>Privacy policy</li>
                 <li>About Us</li>
                 <li>Contact us</li>
               </ul>
            </div>
            <div class="footer-content">
             <h1>Get Help</h1>
             <ul>
               <li>FAQs</li>
               <li>Shipping</li>
               <li>Returns</li>
               <li>Order Status</li>
               <li>Payment options</li>
             </ul>
           </div>
        
           <div class="footer-content">
             <h1>Explore</h1>
             <ul>
               <li>Living Room</li>
               <li>Dining Room</li>
               <li>Bedroom</li>
               <li>Outdoor</li>
               <li>Home Office</li>
             </ul>
           </div>
        
           <div class="footer-content">
             <h1>Follow us</h1>
             <div class="social_links">
               <li><i class="ri-twitter-x-line"></i></li>
               <li><i class="ri-facebook-fill"></i></li>
               <li><i class="ri-instagram-line"></i></li>
               <li><i class="ri-linkedin-line"></i></li>
             </div>
           </div>
           
         </section>

        
        <!-- payment script -->
        <script>
          function showPaymentForm(paymentOption) {
              // Hide all payment option forms
              document.querySelectorAll('.payment-option-form').forEach(form => form.classList.remove('active'));
  
              // Show the selected payment option form
              document.getElementById(`${paymentOption}Form`).classList.add('active');
          }
  
          // Add event listener to radio inputs
          document.querySelectorAll('.cartBar .right form .payment input[type="radio"]').forEach(input => {
              input.addEventListener('change', function () {
                  // Reset border color for all radio inputs
                  document.querySelectorAll('.cartBar .right form .payment input[type="radio"]').forEach(otherInput => {
                      otherInput.style.border = '2px solid #acbebe'; // Set the original border color
                  });
  
                  // Set border color to green for the checked radio input
                  if (this.checked) {
                      this.style.border = '2px solid #4caf50'; // Set the border color to green
                  }
              });
          });
      </script>

<!-- Include this script at the end of your existing script -->
<script>
  // Retrieve the cart data from local storage
  const cartData = JSON.parse(localStorage.getItem('cart')) || [];
  
  // Display the cart items in the checkout page
  const cartItemsContainer = document.getElementById('cartItems');

  const totalPriceButton = document.getElementById('allprice');


  
  
 
// Function to calculate and display the total price
function displayTotalPrice() {
    // Calculate the total price
    const totalPrice = cartData.reduce((total, product) => total + (product.price * product.quantity), 0);

    // Update the content of the total price button
    totalPriceButton.textContent = `Complete Order KES ${totalPrice}`;
    document.getElementById('totalprice').value = totalPrice;
    
    
}


  // Display the cart items in the checkout page
  cartData.forEach((product, index) => {
    const listItem = document.createElement('li');
    listItem.innerHTML = `
    <div style="display:block;">
          <div style="display: flex; align-items: center; gap: 3rem; margin-bottom:10px; font-size:14px;">
            <div style="display: flex; align-items: center; gap:1rem; margin-left:2rem; font-size:14px;">
              <img src="${product.image}" alt="${product.name}" style="max-width: 150px; max-height: 100px; margin-right: 1rem; ">
              
              <strong style="width:300px;font-size:14px;">${product.name}</strong>
              <div style="display:flex; gap:1rem; align-items:center; ">
                <svg  onclick="changeQuantity(${index}, 'decrease')" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="213047"><path d="M5 11V13H19V11H5Z"></path></svg>
                 <input type="text" value="${product.quantity}" id="quantity-${index}" style="width: 40px; height:30px; border: 1px solid #acbebe; text-align: center; outline:none; align-items:center; justify-content:center;" readonly>
                 <svg   onclick="changeQuantity(${index}, 'increase')" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="#213047"><path d="M11 11V5H13V11H19V13H13V19H11V13H5V11H11Z"></path></svg>
               
              </div>
              
              Price: KES ${product.price * product.quantity}
            
            </div>
            <svg onclick="deleteProduct(${index})" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="#213047" style="cursor: pointer;">
              <path d="M11.9997 10.5865L16.9495 5.63672L18.3637 7.05093L13.4139 12.0007L18.3637 16.9504L16.9495 18.3646L11.9997 13.4149L7.04996 18.3646L5.63574 16.9504L10.5855 12.0007L5.63574 7.05093L7.04996 5.63672L11.9997 10.5865Z"></path>
            </svg>
          </div>
          <div style="width: calc(100% - 4rem); margin-left: 2rem; margin-right: 2rem; height: 1px; background-color: #213047; margin-top: 20px;"></div>
        </div>
    `;
    cartItemsContainer.appendChild(listItem);


    document.getElementById('productNames').value = cartData.map(product => product.name).join(',');
document.getElementById('images').value = cartData.map(product => product.image).join(',');
document.getElementById('quantities').value = cartData.map(product => product.quantity).join(',');
document.getElementById('cartData').value = JSON.stringify(cartData);

    
  });

  // Function to delete a product from the cart
  function deleteProduct(index) {
    // Remove the product at the specified index from the cart
    cartData.splice(index, 1);

    // Update the local storage with the modified cart data
    localStorage.setItem('cart', JSON.stringify(cartData));

    // Refresh the display to reflect the updated cart
    displayCartItems();
    displayTotalPrice();
  }

  // Function to refresh the display of cart items
  function displayCartItems() {
    // Clear the current items in the cart display
    cartItemsContainer.innerHTML = '';

    // Display the updated cart items
    cartData.forEach((product, index) => {
      const listItem = document.createElement('li');
      listItem.innerHTML = `
      <div style="display:block;">
          <div style="display: flex; align-items: center; gap: 3rem; margin-bottom:10px; font-size:14px;">
            <div style="display: flex; align-items: center; gap:1rem; margin-left:2rem; font-size:14px;">
              <img src="${product.image}" alt="${product.name}" style="max-width: 150px; max-height: 100px; margin-right: 1rem; ">
              
              <strong style="width:300px;font-size:14px;">${product.name}</strong>
              <div style="display:flex; gap:1rem; align-items:center; ">
                <svg  onclick="changeQuantity(${index}, 'decrease')" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="213047"><path d="M5 11V13H19V11H5Z"></path></svg>
                 <input type="text" value="${product.quantity}" id="quantity-${index}" style="width: 40px; height:30px; border: 1px solid #acbebe; text-align: center; outline:none; align-items:center; justify-content:center;" readonly>
                 <svg   onclick="changeQuantity(${index}, 'increase')" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="#213047"><path d="M11 11V5H13V11H19V13H13V19H11V13H5V11H11Z"></path></svg>
               
              </div>
              
              Price: KES ${product.price * product.quantity}
            
            </div>
            <svg onclick="deleteProduct(${index})" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="18" height="18" fill="#213047" style="cursor: pointer;">
              <path d="M11.9997 10.5865L16.9495 5.63672L18.3637 7.05093L13.4139 12.0007L18.3637 16.9504L16.9495 18.3646L11.9997 13.4149L7.04996 18.3646L5.63574 16.9504L10.5855 12.0007L5.63574 7.05093L7.04996 5.63672L11.9997 10.5865Z"></path>
            </svg>
          </div>
          <div style="width: calc(100% - 4rem); margin-left: 2rem; margin-right: 2rem; height: 1px; background-color: #213047; margin-top: 20px;"></div>
        </div>
      `;
      cartItemsContainer.appendChild(listItem);

      document.getElementById('productNames').value = cartData.map(product => product.name).join(',');
document.getElementById('images').value = cartData.map(product => product.image).join(',');
document.getElementById('quantities').value = cartData.map(product => product.quantity).join(',');
document.getElementById('cartData').value = JSON.stringify(cartData);

    
    });

    // Apply styles to the cartItemsContainer
    //cartItemsContainer.style.display = 'flex';
    //.style.flexDirection = 'column';
    //cartItemsContainer.style.gap = '2rem';
    //cartItemsContainer.style.marginTop = '3rem';
    //cartItemsContainer.style.marginBottom = '20px';
  }

  // Function to change quantity
  function changeQuantity(index, action) {
    const quantityInput = document.getElementById(`quantity-${index}`);
    let currentQuantity = parseInt(quantityInput.value);

    if (action === 'increase') {
      currentQuantity += 1;
    } else if (action === 'decrease' && currentQuantity > 1) {
      currentQuantity -= 1;
    }

    // Update the quantity in the input field
    quantityInput.value = currentQuantity;

    // Update the quantity in the cartData
    cartData[index].quantity = currentQuantity;

    // Update the local storage with the modified cart data
    localStorage.setItem('cart', JSON.stringify(cartData));

    // Refresh the display to reflect the updated cart
    displayCartItems();
    displayTotalPrice();
  }

  // Display the cart items and total price on page load
  displayCartItems();
  displayTotalPrice();
</script>



<script>
  // JavaScript to set the initial value of the date input field
  document.addEventListener('DOMContentLoaded', function () {
    const orderDateTimeInput = document.getElementById('orderDateTime');
    const currentDate = new Date();

    // Format the current date and time in the desired format (Aug 17 2020 5:30pm)
    const formattedDate = new Intl.DateTimeFormat('en-US', {
      year: 'numeric',
      month: 'short',
      day: '2-digit',
      hour: 'numeric',
      minute: 'numeric',
      hour12: true,
    }).format(currentDate);

    orderDateTimeInput.value = formattedDate;
  });
</script>

  
</body>
</html>
